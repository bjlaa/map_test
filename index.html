<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Wigot</title>

    <link rel="stylesheet" href="./css/styles.css">

    

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <!-- Fontawesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <!-- LeafletJs -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA==" crossorigin=""/>

    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js" integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA==" crossorigin=""></script>
    <!-- MapBox -->
    <script src='https://api.mapbox.com/mapbox-gl-js/v0.50.0/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v0.50.0/mapbox-gl.css' rel='stylesheet' />

    <!-- Firebase main script -->
    <script src="https://www.gstatic.com/firebasejs/5.5.6/firebase-app.js"></script>

    <!-- Add additional Firebase services that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/5.5.6/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.5.6/firebase-firestore.js"></script>

    <!-- Firebase UI: interface for authentication -->
    <script src="https://cdn.firebase.com/libs/firebaseui/3.4.1/firebaseui.js"></script>
    <link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/3.4.1/firebaseui.css" />
  </head>

  <body>
    <div id='container'>
      <div ref="modalContainer" class="modalContainer" id="modal">

        <div ref='modalBackground' class="background"></div>
        <div ref="modal" id="modalWigot" class="modalWigot">
        </div>
      </div>
        <div class="col-md-9">
            <!--La carte est ici</h4-->
            <div class="searchBar">
                <input ref='searchInput' type="text" class="searchInput form-control" v-model="inputPin" ref="modif" placeholder="Search for a location or a venue">
                <button type="button" class="searchButton btn btn-primary" @click="searchYelpAPI($refs.searchInput.value)">Search</button>
            </div>
            <div v-if='searchResults' class="searchResults">
                <div class="searchResultItem">
                  <ul>
                    <li><a class="list-group-item list-group-item-action" @click="addMarker()"> {{ searchResults[0].name }} - {{ searchResults[0].location.address1 }}, {{ searchResults[0].location.zip_code }} {{ searchResults[0].location.city }} </a></li>
                    <li><a class="list-group-item list-group-item-action" @click="addMarker()"> {{ searchResults[1].name }} - {{ searchResults[1].location.address1 }}, {{ searchResults[1].location.zip_code }} {{ searchResults[1].location.city }}</a></li>
                    <li><a class="list-group-item list-group-item-action" @click="addMarker()"> {{ searchResults[2].name }} - {{ searchResults[2].location.address1 }}, {{ searchResults[2].location.zip_code }} {{ searchResults[2].location.city }}</a></li>
                    <li><a class="list-group-item list-group-item-action" @click="addMarker()"> {{ searchResults[3].name }} - {{ searchResults[3].location.address1 }}, {{ searchResults[3].location.zip_code }} {{ searchResults[3].location.city }}</a></li>
                    <li><a class="list-group-item list-group-item-action" @click="addMarker()"> {{ searchResults[4].name }} - {{ searchResults[4].location.address1 }}, {{ searchResults[4].location.zip_code }} {{ searchResults[4].location.city }}</a></li>
                  </ul>
                </div>
            </div>
            <i class='icon-spinner icon-spin icon-large'></i>
            <div ref="map" id='map' class="map" style="height: 800px;"></div>  
        </div>
        <div class="col-md-3">
          <aside class="sidebar">
            <div class="logo">
              <div class="logoMain">
                <div class="logoIcon">?</div>
                <div class="logoText"> WIGOT</div>                
              </div>
              <div class="logoBaseline">What is going on tonight?</div>
            </div>
            <br>
            <!-- Titre du Wigot en cours, modifiable par tout le monde (fun) -->
            <div class="wigotTitle"><h3><strong>Titre Wigot</strong></h3></div>

              <div>
                <div class="card">
                  <h3 class="card-header">Meilleur Pin</h3>
                <div class="card-body">
                  <!-- Affichage du meilleur pin en fonction du score. La liste des pins ajoutés est ordonnées en fonction de la valeur score,
                        la partie ci-dessous affiche donc le premier élément [0] du tableau -->
                  <p>Le pin #1 est {{ currentEvent.pins[0] }}</p>
                </div>
                </div>
              </div>
              <div>
                <div class="card">
                  <div class="card-header">
                    <h4>Pins ajoutés :</h4>
                  </div>
                  <div class="card-body">
                    <table>
                      <tbody>
                        <tr v-for="(pin, index) in currentEvent.pins">
                          <td>{{ pin.name }}</td>
                          <td>{{ pin.address }}</td>
                          <td><button type="button">Like</button>
                          <td><button type="button" class="delete" @click="deletePin(index)">Delete</button>  
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <!--
                    Create WIGOT button renderer conditionally
                    if appState is in wigotCreation mode
                  -->
                  <div v-if="appState === appStates.wigotCreation" class="createWigot">
                    <div class="createWigotText">
                      Everything set up? Create your Wigot to start sharing it.
                    </div>
                    <button
                      @click="createEvent"
                      class="createWigotButton"
                    >
                      Create Wigot
                    </button>
                  </div>
                </div>
              </div>
          </aside>
        </div>
    </div>
    <script src="https://unpkg.com/vue@2.0.3/dist/vue.js"></script>
    <script type="text/javascript" src="./js/main.js"></script>
  </body>
</html>